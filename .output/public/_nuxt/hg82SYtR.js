import{_ as M}from"./BGD8fiB9.js";import{_ as T,K as V,k as u,o as F,S as H,x as i,z as t,A as o,N as l,L as p,C as d,M as y,Y as q,O as I,Q as K,y as a,X as Q}from"./bb5wy1fZ.js";import{u as U}from"./C_MYWIpT.js";import{u as W}from"./DKnE3xQg.js";import"./tYwOYGLs.js";const X={class:"container py-5"},Y={class:"row"},J={class:"col-12"},R={class:"d-flex justify-content-between align-items-center mb-4"},Z={class:"text-muted"},$={class:"d-flex gap-2"},tt={class:"row g-4"},st={class:"col-md-6 col-lg-4"},et={class:"card h-100 shadow-sm"},lt={class:"card-body text-center"},nt={class:"card-text"},ot={class:"card-text"},it={class:"badge bg-primary"},at={class:"card-text"},rt={class:"col-md-6 col-lg-4"},dt={class:"card h-100 shadow-sm"},ct={class:"card-body text-center"},ut={key:0,class:"text-center py-3"},mt={key:1,class:"text-center py-3"},bt={key:2},vt={class:"row text-center"},_t={class:"col-6"},gt={class:"text-primary"},pt={class:"col-6"},yt={class:"text-success"},xt={class:"row text-center mt-3"},ht={class:"col-6"},ft={class:"text-info"},wt={class:"col-6"},kt={class:"text-warning"},Ct={class:"row text-center mt-3"},jt={class:"col-6"},Ot={class:"text-danger"},zt={class:"col-6"},Dt={class:"text-secondary"},Pt={class:"row text-center mt-3"},At={class:"col-12"},Et={class:"text-dark"},Nt={key:0,class:"mt-3"},St={class:"progress",style:{height:"8px"}},Bt=["title"],Gt={class:"text-muted"},Lt={key:1,class:"mt-3"},Mt={class:"col-md-6 col-lg-4"},Tt={class:"card h-100 shadow-sm"},Vt={class:"card-body text-center"},Ft={class:"d-grid gap-2"},Ht={class:"row mt-5"},qt={class:"col-12"},It={class:"card shadow-sm"},Kt={class:"card-body"},Qt={key:0,class:"text-center py-4"},Ut={key:1,class:"text-center py-4 text-danger"},Wt={key:2,class:"text-center py-4 text-muted"},Xt={key:3,class:"table-responsive"},Yt={class:"table table-hover"},Jt=["src","alt"],Rt={key:0,class:"badge bg-success"},Zt={key:1,class:"badge bg-secondary"},$t={class:"text-muted"},ts={__name:"admin",setup(ss){V({title:"لوحة الإدارة | Güzel",meta:[{name:"robots",content:"noindex, nofollow"},{name:"googlebot",content:"noindex, nofollow"},{name:"description",content:"لوحة إدارة متجر Güzel - غير مخصصة للفهرسة"}]});const{user:x,isAdmin:O,logout:h,initAuth:z,waitForAuth:D}=U(),{allProducts:n,loading:f,error:v,loadProducts:w}=W(),m=u(()=>n.value?Object.keys(n.value).length:0),k=u(()=>n.value?Object.values(n.value).filter(e=>e.best_seller===!0).length:0),P=u(()=>n.value?Object.values(n.value).filter(e=>e.category==="man").length:0),A=u(()=>n.value?Object.values(n.value).filter(e=>e.category==="women").length:0),E=u(()=>n.value?Object.values(n.value).filter(e=>e.category==="lapels").length:0),N=u(()=>n.value?Object.values(n.value).filter(e=>e.discount>0).length:0),S=u(()=>{if(!n.value||Object.keys(n.value).length===0)return 0;const e=Object.values(n.value).reduce((s,c)=>s+(c.price||0),0);return Math.round(e/Object.keys(n.value).length)}),_=u(()=>!n.value||m.value===0?0:Math.round(k.value/m.value*100)),C=u(()=>n.value?Object.entries(n.value).map(([s,c])=>({id:s,...c})).sort((s,c)=>{const b=s.created_at?new Date(s.created_at).getTime():0;return(c.created_at?new Date(c.created_at).getTime():0)-b}).slice(0,5):[]);F(async()=>{try{const e=z();await D(),await w(),H(()=>{e&&e()})}catch(e){console.error("Error initializing admin page:",e)}});const j=async()=>{await w();const e=document.createElement("div");e.className="toast-success",e.innerHTML=`
    <i class="bi bi-check-circle"></i>
    تم تحديث البيانات بنجاح
  `,document.body.appendChild(e),setTimeout(()=>{document.body.contains(e)&&document.body.removeChild(e)},3e3)},B=e=>{switch(e){case"man":return"bg-primary";case"women":return"bg-warning";case"lapels":return"bg-danger";default:return"bg-secondary"}},G=e=>{switch(e){case"man":return"رجالي";case"women":return"نسائي";case"lapels":return"بلبس";default:return"غير معرف"}};return(e,s)=>{var b,g;const c=M;return a(),i("div",X,[t("div",Y,[t("div",J,[t("div",R,[t("div",null,[s[2]||(s[2]=t("h1",{class:"mb-2"},"لوحة الإدارة",-1)),t("p",Z,"مرحباً "+o((b=l(x))==null?void 0:b.email),1)]),t("div",$,[t("button",{class:"btn btn-outline-secondary",onClick:s[0]||(s[0]=(...r)=>l(h)&&l(h)(...r))},s[3]||(s[3]=[t("i",{class:"bi bi-box-arrow-right me-1"},null,-1),d(" تسجيل الخروج ")])),p(c,{to:"/crud",class:"btn btn-primary"},{default:y(()=>s[4]||(s[4]=[t("i",{class:"bi bi-gear me-1"},null,-1),d(" إدارة المنتجات ")])),_:1,__:[4]})])])])]),t("div",tt,[t("div",st,[t("div",et,[t("div",lt,[s[11]||(s[11]=t("div",{class:"mb-3"},[t("i",{class:"bi bi-person-circle",style:{"font-size":"3rem",color:"#667eea"}})],-1)),s[12]||(s[12]=t("h5",{class:"card-title"},"معلومات المستخدم",-1)),t("p",nt,[s[5]||(s[5]=t("strong",null,"البريد الإلكتروني:",-1)),s[6]||(s[6]=t("br",null,null,-1)),d(" "+o((g=l(x))==null?void 0:g.email),1)]),t("p",ot,[s[7]||(s[7]=t("strong",null,"نوع الحساب:",-1)),s[8]||(s[8]=t("br",null,null,-1)),t("span",it,o(l(O)?"مدير":"مستخدم"),1)]),t("p",at,[s[9]||(s[9]=t("strong",null,"تاريخ تسجيل الدخول:",-1)),s[10]||(s[10]=t("br",null,null,-1)),d(" "+o(new Date().toLocaleDateString("ar-EG")),1)])])])]),t("div",rt,[t("div",dt,[t("div",ct,[s[25]||(s[25]=t("div",{class:"mb-3"},[t("i",{class:"bi bi-graph-up",style:{"font-size":"3rem",color:"#48bb78"}})],-1)),s[26]||(s[26]=t("h5",{class:"card-title"},"إحصائيات سريعة",-1)),l(f)?(a(),i("div",ut,s[13]||(s[13]=[t("div",{class:"spinner-border spinner-border-sm text-primary",role:"status"},[t("span",{class:"visually-hidden"},"جار التحميل...")],-1),t("p",{class:"text-muted mt-2"},"جاري تحميل الإحصائيات...",-1)]))):l(v)?(a(),i("div",mt,[s[15]||(s[15]=t("i",{class:"bi bi-exclamation-triangle text-danger",style:{"font-size":"2rem"}},null,-1)),s[16]||(s[16]=t("p",{class:"text-danger mt-2"},"خطأ في تحميل البيانات",-1)),t("button",{class:"btn btn-sm btn-outline-primary",onClick:j},s[14]||(s[14]=[t("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),d(" إعادة المحاولة ")]))])):(a(),i("div",bt,[t("div",vt,[t("div",_t,[t("h4",gt,o(l(m)),1),s[17]||(s[17]=t("small",{class:"text-muted"},"المنتجات",-1))]),t("div",pt,[t("h4",yt,o(l(k)),1),s[18]||(s[18]=t("small",{class:"text-muted"},"الأكثر مبيعاً",-1))])]),t("div",xt,[t("div",ht,[t("h4",ft,o(l(P)),1),s[19]||(s[19]=t("small",{class:"text-muted"},"رجالي",-1))]),t("div",wt,[t("h4",kt,o(l(A)),1),s[20]||(s[20]=t("small",{class:"text-muted"},"نسائي",-1))])]),t("div",Ct,[t("div",jt,[t("h4",Ot,o(l(E)),1),s[21]||(s[21]=t("small",{class:"text-muted"},"بلبس",-1))]),t("div",zt,[t("h4",Dt,o(l(N)),1),s[22]||(s[22]=t("small",{class:"text-muted"},"بخصم",-1))])]),t("div",Pt,[t("div",At,[t("h4",Et,o(l(S))+" EGP",1),s[23]||(s[23]=t("small",{class:"text-muted"},"متوسط السعر",-1))])]),l(m)>0?(a(),i("div",Nt,[t("div",St,[t("div",{class:"progress-bar bg-success",style:q({width:l(_)+"%"}),title:"نسبة الأكثر مبيعاً: "+l(_)+"%"},null,12,Bt)]),t("small",Gt,"نسبة الأكثر مبيعاً ("+o(l(_))+"%)",1)])):(a(),i("div",Lt,s[24]||(s[24]=[t("p",{class:"text-muted"},"لا توجد منتجات متاحة",-1)])))]))])])]),t("div",Mt,[t("div",Tt,[t("div",Vt,[s[30]||(s[30]=t("div",{class:"mb-3"},[t("i",{class:"bi bi-lightning",style:{"font-size":"3rem",color:"#f56565"}})],-1)),s[31]||(s[31]=t("h5",{class:"card-title"},"إجراءات سريعة",-1)),t("div",Ft,[p(c,{to:"/crud",class:"btn btn-outline-primary"},{default:y(()=>s[27]||(s[27]=[t("i",{class:"bi bi-plus-circle me-1"},null,-1),d(" إضافة منتج جديد ")])),_:1,__:[27]}),p(c,{to:"/crud",class:"btn btn-outline-success"},{default:y(()=>s[28]||(s[28]=[t("i",{class:"bi bi-pencil-square me-1"},null,-1),d(" تعديل المنتجات ")])),_:1,__:[28]}),t("button",{class:"btn btn-outline-info",onClick:j},s[29]||(s[29]=[t("i",{class:"bi bi-arrow-clockwise me-1"},null,-1),d(" تحديث البيانات ")]))])])])])]),t("div",Ht,[t("div",qt,[t("div",It,[s[37]||(s[37]=t("div",{class:"card-header"},[t("h5",{class:"mb-0"},[t("i",{class:"bi bi-clock-history me-2"}),d(" أحدث المنتجات ")])],-1)),t("div",Kt,[l(f)?(a(),i("div",Qt,s[32]||(s[32]=[t("div",{class:"spinner-border text-primary",role:"status"},[t("span",{class:"visually-hidden"},"جار التحميل...")],-1)]))):l(v)?(a(),i("div",Ut,[s[33]||(s[33]=t("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),d(" "+o(l(v)),1)])):l(C).length?(a(),i("div",Xt,[t("table",Yt,[s[36]||(s[36]=t("thead",null,[t("tr",null,[t("th",null,"الصورة"),t("th",null,"الاسم"),t("th",null,"السعر"),t("th",null,"الفئة"),t("th",null,"الأكثر مبيعاً"),t("th",null,"تاريخ الإنشاء")])],-1)),t("tbody",null,[(a(!0),i(I,null,K(l(C),r=>(a(),i("tr",{key:r.id},[t("td",null,[t("img",{src:r.image,alt:r.name,style:{width:"40px",height:"40px","object-fit":"cover","border-radius":"4px"},onError:s[1]||(s[1]=L=>L.target.src="/logo.png")},null,40,Jt)]),t("td",null,o(r.name),1),t("td",null,o(r.price)+" EGP",1),t("td",null,[t("span",{class:Q(["badge",B(r.category)])},o(G(r.category)),3)]),t("td",null,[r.best_seller?(a(),i("span",Rt,s[34]||(s[34]=[t("i",{class:"bi bi-check me-1"},null,-1),d("نعم ")]))):(a(),i("span",Zt,s[35]||(s[35]=[t("i",{class:"bi bi-x me-1"},null,-1),d("لا ")])))]),t("td",null,[t("small",$t,o(r.created_at?new Date(r.created_at).toLocaleDateString("ar-EG"):"غير محدد"),1)])]))),128))])])])):(a(),i("div",Wt," لا توجد منتجات متاحة "))])])])])])}}},as=T(ts,[["__scopeId","data-v-5aea13ca"]]);export{as as default};
